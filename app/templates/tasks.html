{% extends "base.html" %}

{% block content %}
<h2>My Tasks</h2>
<p>Welcome, {{ current_user.username }}! | <a href="{{ url_for('main.logout') }}">Logout</a></p>

<h3>Add New Task</h3>
<form method="POST" action="{{ url_for('main.add_task') }}">
    <input type="text" name="title" placeholder="Task title" required>
    <textarea name="description" placeholder="Description (optional)" rows="3"></textarea>
    <input type="submit" value="Add Task">
</form>

<h3>Your Tasks</h3>
{% if tasks %}
    {% for task in tasks %}
        <div class="task {% if task.completed %}completed{% endif %}">
            <div>
                <strong>{{ task.title }}</strong>
                {% if task.description %}<p>{{ task.description }}</p>{% endif %}
                <small>Created: {{ task.created_at.strftime('%Y-%m-%d %H:%M') }}</small>
            </div>
            <div>
                <form method="POST" action="{{ url_for('main.complete_task', task_id=task.id) }}" style="display: inline;">
                    <button type="submit">{% if task.completed %}Undo{% else %}Complete{% endif %}</button>
                </form>
                <form method="POST" action="{{ url_for('main.delete_task', task_id=task.id) }}" style="display: inline;">
                    <button type="submit" style="background: #dc3545;">Delete</button>
                </form>
            </div>
        </div>
    {% endfor %}
{% else %}
    <p>No tasks yet. Add one above!</p>
{% endif %}
{% endblock %}
